{% extends 'base.html' %}

{% block title %}Book Appointment{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Book New Appointment</h2>
    
    <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="{{ url_for('patient.dashboard') }}">Dashboard</a></li>
            <li class="breadcrumb-item active">Book Appointment</li>
        </ol>
    </nav>
    
    <div class="row">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <i class="fas fa-calendar-plus"></i> Appointment Details
                </div>
                <div class="card-body">
                    <form method="POST" action="{{ url_for('patient.book_appointment') }}">
                        {{ form.hidden_tag() }}
                        <div class="form-group">
                            <label for="doctor_id"><strong>Select Doctor</strong></label>
                            {{ form.doctor_id(class="form-control") }}
                        </div>
                        <div class="form-group mt-3">
                            <label for="appointment_date"><strong>Appointment Date & Time</strong></label>
                            {{ form.appointment_date(class="form-control") }}
                        </div>
                        <div class="form-group mt-3">
                            <label for="reason"><strong>Reason for Appointment</strong></label>
                            {{ form.reason(class="form-control", rows=4) }}
                        </div>
                        <div class="mt-4">
                            <a href="{{ url_for('patient.dashboard') }}" class="btn btn-secondary">
                                <i class="fas fa-arrow-left"></i> Back
                            </a>
                            <button type="submit" class="btn btn-primary float-end">
                                <i class="fas fa-calendar-check"></i> Book Appointment
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        
        <div class="col-md-4">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <i class="fas fa-info-circle"></i> Booking Instructions
                </div>
                <div class="card-body">
                    <h5>Need Help?</h5>
                    <p>If you need assistance booking your appointment or have questions, please contact our support team:</p>
                    <p><i class="fas fa-phone"></i> (555) 123-4567</p>
                    <p><i class="fas fa-envelope"></i> support@hospital.com</p>
                    
                    <h5 class="mt-4">Appointment Guidelines</h5>
                    <ul>
                        <li>Appointments must be scheduled at least 24 hours in advance</li>
                        <li>You can only book appointments on weekdays (Monday to Friday)</li>
                        <li>Available hours: 8:00 AM to 6:00 PM</li>
                        <li>Please arrive 15 minutes before your scheduled time</li>
                        <li>Bring your insurance information and ID</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Doctor Information Card - Will be shown when a doctor is selected -->
    <div class="row mt-4" id="doctorInfoCard" style="display: none;">
        <div class="col-md-8">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <i class="fas fa-user-md"></i> Doctor Information
                </div>
                <div class="card-body" id="doctorInfo">
                    <!-- Doctor information will be populated here via JavaScript -->
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // JavaScript to show doctor information when selected
    document.getElementById('doctor_id').addEventListener('change', function() {
        const doctorId = this.value;
        if (!doctorId) {
            document.getElementById('doctorInfoCard').style.display = 'none';
            return;
        }
        
        // Find the selected doctor information
        const doctors = [
            {% for doctor in doctors %}
            {
                id: {{ doctor.id }},
                name: "Dr. {{ doctor.first_name }} {{ doctor.last_name }}",
                specialization: "{{ doctor.specialization }}",
                email: "{{ doctor.email }}",
                contactNumber: "{{ doctor.contact_number }}"
            },
            {% endfor %}
        ];
        
        const selectedDoctor = doctors.find(doc => doc.id == doctorId);
        
        // Display doctor information
        if (selectedDoctor) {
            document.getElementById('doctorInfo').innerHTML = `
                <h5>${selectedDoctor.name}</h5>
                <p><strong>Specialization:</strong> ${selectedDoctor.specialization}</p>
                <p><strong>Contact:</strong> ${selectedDoctor.contactNumber}</p>
                <p><strong>Email:</strong> ${selectedDoctor.email}</p>
            `;
            document.getElementById('doctorInfoCard').style.display = 'block';
        }
    });
</script>
{% endblock %}